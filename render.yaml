# Render Deployment Configuration
# Deploy backend services from GHCR to Render

services:
  - type: web
    name: neighborwatch-api
    runtime: image
    image:
      url: ghcr.io/dukuzejean09/neighborwatch-api:latest
    envVars:
      - key: MONGODB_URL
        sync: false
      - key: DATABASE_NAME
        value: neighborwatch
      - key: SECRET_KEY
        generateValue: true
    healthCheckPath: /health

  - type: worker
    name: neighborwatch-clustering
    runtime: image
    image:
      url: ghcr.io/dukuzejean09/neighborwatch-clustering:latest
    envVars:
      - key: MONGODB_URL
        sync: false
      - key: DATABASE_NAME
        value: neighborwatch
      - key: API_URL
        fromService:
          name: neighborwatch-api
          type: web
          property: host

  - type: pserv
    name: neighborwatch-mongodb
    runtime: docker
    dockerfilePath: ./Dockerfile.mongo
    disk:
      name: mongodb-data
      mountPath: /data/db
      sizeGB: 10
